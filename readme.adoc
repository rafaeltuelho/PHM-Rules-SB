= Population Health Management

Read this blog for more information:

https://developers.redhat.com/blog/2020/02/19/designing-an-event-driven-business-process-at-scale-a-health-management-example-part-1/

=== Local Execution

Go to the *-service directory and run
[source,bash]
----
. ./launch.sh clean install
----
Then post the following payload
[source,json]
----
{
	"lookup": "myStateless",
    "commands": [
        {
            "insert": {
                "object": {
                    "com.health_insurance.phm_model.Trigger": {
                        "triggerId": 74,
                        "memberId": "xyz123"
                    }
                },
                "out-identifier": "trigger",
                "return-object": false
            }
        },
        {
            "fire-all-rules": {}
        },
        {
            "get-objects": {
                "out-identifier": "result_facts"
            }
        }
    ]
}
----
to the url http://localhost:8090/rest/server/containers/instances/PHM-Rules-SB-kjar-1_0

You can use Postman with Basic Auth `user/user`

or Curl
[source,bash]
----
curl --location --request POST 'http://localhost:8090/rest/server/containers/instances/PHM-Rules-SB-kjar-1_0' \
--header 'Content-Type: application/json' \
--header 'Authorization: Basic a2llLXNlcnZlcjpraWUtc2VydmVy' \
--header 'X-KIE-ContentType: JSON' \
--header 'Accept: application/json' \
--header 'Authorization: Basic dXNlcjp1c2Vy' \
--header 'Content-Type: text/plain' \
--header 'Cookie: JSESSIONID=C2C81BE4ED2177D8057FA8E41D408AFD' \
--data-raw '{
	"lookup": "myStateless",
    "commands": [
        {
            "insert": {
                "object": {
                    "com.health_insurance.phm_model.Trigger": {
                        "triggerId": 74,
                        "memberId": "xyz123"
                    }
                },
                "out-identifier": "trigger",
                "return-object": false
            }
        },
        {
            "fire-all-rules": {}
        },
        {
            "get-objects": {
                "out-identifier": "result_facts"
            }
        }
    ]
}'
----

=== Docker Execution

With docker running, in the *-service directory run
[source,bash]
----
. ./launch.sh clean install -Pdocker,h2
----
Then you should be able to continue as in the local execution.